Based on obar by smaltore (smaltore@foxmail.com).
